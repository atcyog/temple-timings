<!doctype html>
<html lang="ta">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tamil Nadu ‚Äì Kumbabishegam Tracker</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 0; background:#fff8f0; color:#222; }
    header { background:#7a1f1f; color:#fff; padding:16px; }
    .wrap { padding: 12px; }
    .card { background:#fff; border-radius:12px; padding:12px; box-shadow: 0 2px 8px rgba(0,0,0,.08); margin: 12px 0; }
    input, textarea { width:100%; padding:10px; border-radius:10px; border:1px solid #ddd; font-size: 14px; }
    button { padding:10px 12px; border:0; border-radius:10px; background:#7a1f1f; color:#fff; font-size:14px; }
    table { width:100%; border-collapse: collapse; }
    th, td { text-align:left; padding:10px; border-bottom:1px solid #eee; vertical-align: top; }
    th { position: sticky; top: 0; background:#fff; }
    small { color:#555; }
    .pill { display:inline-block; padding:2px 8px; border-radius:999px; background:#f3e0e0; color:#7a1f1f; font-size:12px; }
  </style>
</head>
<body>
<header>
  <h2 style="margin:0;">üõï Tamil Nadu ‚Äì Kumbabishegam Dates</h2>
  <div><small>Enter last known dates ‚Üí get next possible year/month (rule-of-thumb: +12 years)</small></div>
</header>

<div class="wrap">
  <div class="card">
    <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
      <button id="loadDemo">Load demo</button>
      <button id="calc">Calculate</button>
      <span class="pill">Date format: YYYY-MM-DD</span>
    </div>
    <p style="margin:10px 0 6px;"><b>Paste your temple data (CSV):</b></p>
    <textarea id="csv" rows="8" placeholder="Temple Name, District, Last Kumbabishegam Date (YYYY-MM-DD)
Arulmigu ______ Temple, Madurai, 2009-04-25
..."></textarea>
    <p style="margin:8px 0 0;"><small>Tip: Start with 20‚Äì50 temples you know. Later you can expand.</small></p>
  </div>

  <div class="card">
    <h3 style="margin:0 0 8px;">Results</h3>
    <div style="overflow:auto;">
      <table id="tbl">
        <thead>
          <tr>
            <th>Temple</th>
            <th>District</th>
            <th>Last date</th>
            <th>Next possible (year‚Äìmonth)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <div class="card">
    <b>Note on ‚Äúnext possible‚Äù:</b>
    <div style="margin-top:6px;">
      Many temples follow a ~12-year rejuvenation cycle for kumbabishegam (actual scheduling can shift due to renovations, finances, approvals, and muhurtham). So this page gives a practical estimate, not a guarantee.
    </div>
  </div>
</div>

<script>
  // Rule-of-thumb: next = last + 12 years (keep same month; day is not important for "year-month").
  function nextYearMonth(lastDateStr) {
    if (!lastDateStr) return "";
    const d = new Date(lastDateStr);
    if (Number.isNaN(d.getTime())) return "Invalid date";
    const next = new Date(d);
    next.setFullYear(next.getFullYear() + 12);
    const ym = next.toLocaleDateString("en-IN", { year: "numeric", month: "long" });
    return ym; // e.g., "July 2037"
  }

  function parseCSV(text) {
    // very simple CSV: Temple, District, Date
    return text.split("\n")
      .map(l => l.trim())
      .filter(l => l && !l.startsWith("#"))
      .map(line => {
        const parts = line.split(",").map(s => s.trim());
        return { temple: parts[0] || "", district: parts[1] || "", last: parts[2] || "" };
      })
      .filter(r => r.temple && r.temple.toLowerCase() !== "temple name");
  }

  function render(rows) {
    const tbody = document.querySelector("#tbl tbody");
    tbody.innerHTML = "";
    rows.forEach(r => {
      const tr = document.createElement("tr");
      const next = nextYearMonth(r.last);
      tr.innerHTML = `
        <td>${escapeHtml(r.temple)}</td>
        <td>${escapeHtml(r.district)}</td>
        <td>${escapeHtml(r.last)}</td>
        <td>${escapeHtml(next)}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function escapeHtml(s) {
    return String(s).replace(/[&<>"']/g, c => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[c]));
  }

  document.getElementById("calc").addEventListener("click", () => {
    const rows = parseCSV(document.getElementById("csv").value);
    render(rows);
  });

  document.getElementById("loadDemo").addEventListener("click", () => {
    document.getElementById("csv").value =
`Temple Name, District, Last Kumbabishegam Date (YYYY-MM-DD)
Arulmigu Example Temple, Chennai, 2013-06-10
Arulmigu Example Amman Temple, Madurai, 2016-02-03
Arulmigu Example Murugan Temple, Coimbatore, 2012-11-25`;
  });
</script>
</body>
</html>

